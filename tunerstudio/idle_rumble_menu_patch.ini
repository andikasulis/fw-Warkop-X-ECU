
; ════════════════════════════════════════════════════════════════════════════
; IDLE RUMBLE CUSTOM MENU - TunerStudio .ini Patch
; ════════════════════════════════════════════════════════════════════════════
; 
; ADD THIS TO YOUR rusefi_warkop_x.ini FILE
; 
; Instructions:
; 1. Download rusefi_warkop_x.ini from GitHub Actions artifacts
; 2. Open with text editor (Notepad++, VSCode, etc.)
; 3. Find [Dialogs] section
; 4. Add "DIALOG DEFINITION" below at END of [Dialogs] section
; 5. Find [Menu] section  
; 6. Add "MENU INTEGRATION" below to [Menu] section
; 7. Save file
; 8. Load in TunerStudio: File → Project → Open Project
; 9. Select modified .ini → Open
; 10. Check menu bar for "⚡ Idle Rumble"!
;
; ════════════════════════════════════════════════════════════════════════════

; ────────────────────────────────────────────────────────────────────────────
; DIALOG DEFINITION
; Add this to [Dialogs] section (at the end, before next section starts)
; ────────────────────────────────────────────────────────────────────────────

   ; Idle Rumble Custom Dialog - Warkop-X ECU
   dialog = idleRumbleDialog, "⚡ Idle Rumble - Drumbal Effect"
      panel = idleRumblePanel
      
   panel = idleRumblePanel
      ; Header Info
      field = "#Idle Rumble creates aggressive idle sound via timing/fuel variation"
      field = "#Works with cable throttle (no idle valve needed)"
      field = ""
      
      ; Enable Toggle
      field = "Enable Idle Rumble", idleRumbleEnabled
      field = ""
      
      ; Basic Settings Section
      field = "─────────── Basic Settings ───────────"
      field = "Rumble Amplitude (%)", idleRumbleAmplitude, {idleRumbleEnabled == 1}
      field = "  Controls strength of rumble effect (0-100%)"
      field = ""
      field = "Rumble Speed/Period", idleRumblePeriod, {idleRumbleEnabled == 1}
      field = "  Lower = faster bounce, Higher = slower lope"
      field = ""
      
      ; Method Selection Section
      field = "─────────── Rumble Method ───────────"
      field = "Method", idleRumbleMethod, {idleRumbleEnabled == 1}
      field = "  0 = Timing Only (smooth)"
      field = "  1 = Fuel Only (aggressive)"
      field = "  2 = Spark Cut (popping sound)"
      field = "  3 = Combined Timing+Fuel (recommended)"
      field = ""
      
      ; Advanced Tuning Section
      field = "─────────── Advanced Tuning ───────────"
      field = "Max Timing Offset (degrees)", idleRumbleTiming, {idleRumbleEnabled == 1 && (idleRumbleMethod == 0 || idleRumbleMethod == 3)}
      field = "  Amount of ignition timing variation (±10°)"
      field = ""
      field = "Max Fuel Adjustment (%)", idleRumbleFuel, {idleRumbleEnabled == 1 && (idleRumbleMethod == 1 || idleRumbleMethod == 3)}
      field = "  Amount of fuel variation (±20%)"
      field = ""
      
      ; Activation Limits Section
      field = "─────────── Activation Limits ───────────"
      field = "Max Active RPM", idleRumbleMaxRpm, {idleRumbleEnabled == 1}
      field = "  Rumble only active below this RPM"
      field = ""
      field = "Max Active TPS (%)", idleRumbleMaxTps, {idleRumbleEnabled == 1}
      field = "  Rumble only active below this throttle position"
      field = ""
      
      ; Recommended Presets
      field = "─────────── Recommended Presets ───────────"
      field = "Subtle Daily:"
      field = "  Amplitude: 30%, Period: 6, Method: 0"
      field = ""
      field = "Medium (Recommended):"
      field = "  Amplitude: 50%, Period: 5, Method: 3"
      field = "  Timing: 4°, Fuel: 10%"
      field = ""
      field = "Aggressive Racing:"
      field = "  Amplitude: 70%, Period: 3, Method: 3"
      field = "  Timing: 5°, Fuel: 15%"
      field = ""
      field = "Harley V-Twin Style:"
      field = "  Amplitude: 60%, Period: 9, Method: 3"

; ────────────────────────────────────────────────────────────────────────────
; MENU INTEGRATION
; Add this to [Menu] section (inside menuDialog = main block)
; ────────────────────────────────────────────────────────────────────────────

      ; Custom Idle Rumble Menu
      subMenu = idleRumbleDialog, "⚡ Idle Rumble"

; ════════════════════════════════════════════════════════════════════════════
; END OF PATCH
; ════════════════════════════════════════════════════════════════════════════
;
; After adding this code:
; - Save the .ini file
; - Load in TunerStudio
; - Look for "⚡ Idle Rumble" in the menu bar
; - Click to open custom dialog with all settings!
;
; Note: You'll need to re-apply this patch each time you download a new .ini
; from GitHub Actions. Consider using the auto-patch script for automation.
;
; ════════════════════════════════════════════════════════════════════════════
